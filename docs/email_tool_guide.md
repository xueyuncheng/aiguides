# 邮件查询工具使用指南

## 功能概述

邮件查询工具允许 AI 助手通过 IMAP 协议连接到邮件服务器，查询和读取邮箱中的邮件。

## 支持的功能

- 连接到 IMAP 邮件服务器（支持 TLS 加密）
- 查询指定邮箱文件夹中的邮件（默认为 INBOX）
- 支持过滤未读邮件
- 限制返回的邮件数量（默认 10 封，最多 50 封）
- 获取邮件的基本信息：主题、发件人、收件人、日期、正文等
- 检查邮件是否已读

## 使用示例

### 基本用法

向 AI 助手提出如下请求：

```
请查询我的邮箱 test@example.com 中的最新邮件
```

AI 助手会要求你提供以下信息：
- IMAP 服务器地址（例如：imap.gmail.com:993）
- 邮箱账号
- 邮箱密码或应用专用密码

### 查询未读邮件

```
请查询我邮箱中的未读邮件
```

### 查询特定数量的邮件

```
请查询我邮箱中最新的 20 封邮件
```

### 查询特定文件夹

```
请查询我邮箱中 Sent 文件夹的邮件
```

## 常见邮箱服务器配置

### Gmail
- 服务器地址：`imap.gmail.com:993`
- 需要使用应用专用密码（不能使用普通密码）
- 参考：https://support.google.com/accounts/answer/185833

### Outlook/Hotmail
- 服务器地址：`outlook.office365.com:993`

### QQ 邮箱
- 服务器地址：`imap.qq.com:993`
- 需要先在邮箱设置中开启 IMAP 服务并获取授权码

### 163 邮箱
- 服务器地址：`imap.163.com:993`
- 需要先在邮箱设置中开启 IMAP 服务并获取授权码

## 安全说明

⚠️ **重要提示**：
- 邮箱密码会在查询过程中使用，但不会被存储
- 建议使用应用专用密码而不是主密码
- 确保在安全的网络环境中使用
- 所有连接使用 TLS 加密

## 技术实现

- 使用 IMAP 协议（Internet Message Access Protocol）进行邮件查询
- 支持 TLS/SSL 加密连接
- 基于 [go-imap v2](https://github.com/emersion/go-imap) 库实现

## 参数说明

### 输入参数

- `server` (必填): IMAP 服务器地址，格式为 `hostname:port`，例如 `imap.gmail.com:993`
- `username` (必填): 邮箱账号
- `password` (必填): 邮箱密码或应用专用密码
- `mailbox` (可选): 邮箱文件夹名称，默认为 `INBOX`
- `limit` (可选): 返回的邮件数量限制，默认为 10，最多 50
- `unseen` (可选): 是否只查询未读邮件，默认为 `false`

### 输出结果

返回的每封邮件包含以下信息：
- `uid`: 邮件唯一标识符
- `subject`: 邮件主题
- `from`: 发件人
- `to`: 收件人
- `date`: 发送日期
- `seen`: 是否已读
- `body_text`: 邮件正文（文本内容）

## 故障排查

### 连接失败

1. 检查服务器地址是否正确
2. 确认邮箱服务是否已开启 IMAP 服务
3. 检查网络连接和防火墙设置

### 登录失败

1. 确认用户名和密码是否正确
2. 对于 Gmail 等服务，确认是否使用了应用专用密码
3. 检查邮箱是否开启了两步验证

### 无法读取邮件

1. 确认指定的邮箱文件夹名称是否正确
2. 检查邮箱中是否确实有邮件
3. 查看日志获取更详细的错误信息
